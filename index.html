<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>앱 사용 시간 분석 (10/27 - 11/02)</title>
  <style>
    :root {
      --bg: #f5f0e8;
      --panel: rgba(251,247,240,0.92);
      --text: #1d1d1b;
      --shadow: rgba(29,29,27,0.12);
      --brand-black: #0f0f0f;
      --brand-mid: #34322f;
    }
    body {
      margin: 0;
      font-family: 'IBM Plex Sans', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
      color: var(--text);
      background: var(--bg);
      min-height: 100vh;
      letter-spacing: 0.01em;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      overflow: hidden;
    }
    .site-title {
      margin: 0;
      padding: 20px 24px 10px;
      width: 100%;
      text-align: center;
      font-family: 'Helvetica', 'Arial', sans-serif;
      font-size: clamp(3rem, 8vw, 5.5rem);
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .page {
      flex: 1;
      width: 100%;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding-top: 0;
    }
    .chart-container {
      position: relative;
      width: min(94vmin, 960px);
      height: min(94vmin, 960px);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: visible;
      margin: -16px auto 0;
    }
    .chart-container svg {
      width: 100%;
      height: 100%;
    }
    .tooltip {
      position:absolute;
      background: rgba(15,15,15,0.94);
      color:#fdfaf5;
      padding: 13px 18px;
      border-radius:12px;
      box-shadow: 0 18px 40px rgba(15,15,15,0.35);
      z-index:20;
      display:none;
      pointer-events: none;
      border: 1px solid rgba(255,255,255,0.08);
      letter-spacing: 0.04em;
    }
    .tooltip .name { font-size: 13px; font-weight: 600; margin-bottom: 6px; letter-spacing: 0.08em; text-transform: uppercase; }
    .tooltip .row { font-size: 11px; color:rgba(248,244,236,0.88); margin: 2px 0; white-space: nowrap; }
    svg#chart {
      border-radius: 50%;
      background: transparent;
    }
    text { font-family: inherit; }
  </style>
  </head>
<body>
  <header class="site-title">My Overwork Clock</header>
  <div class="page">
    <div class="chart-container">
      <svg id="chart" width="880" height="880" viewBox="0 0 880 880" preserveAspectRatio="xMidYMid meet" role="img" aria-label="앱 사용 시간대 원형 시각화"></svg>
        <div id="tooltip" class="tooltip">
          <div class="name"></div>
          <div class="row date"></div>
          <div class="row time"></div>
        <div class="row duration"></div>
          <div class="row category"></div>
      </div>
    </div>
  </div>
  <script>
    // 원본 앱 사용 이벤트 (앱사용_상세분석.xlsx 기반)
    const rawUsageEvents = [
      { date: '2024-10-27', app: 'Google Chrome', start: '2024-10-27T01:30', duration: 145, category: '기타' },
      { date: '2024-10-27', app: 'Cursor', start: '2024-10-27T03:00', duration: 142, category: '생산성 및 금융' },
      { date: '2024-10-27', app: 'Figma', start: '2024-10-27T04:30', duration: 76, category: '생산성 및 금융' },
      { date: '2024-10-27', app: '메모', start: '2024-10-27T14:00', duration: 49, category: '생산성 및 금융' },
      { date: '2024-10-27', app: '카카오톡', start: '2024-10-27T16:00', duration: 47, category: '소셜 미디어' },
      { date: '2024-10-28', app: 'Cursor', start: '2024-10-28T13:30', duration: 130, category: '생산성 및 금융' },
      { date: '2024-10-28', app: 'Google Chrome', start: '2024-10-28T15:00', duration: 102, category: '기타' },
      { date: '2024-10-28', app: 'Figma', start: '2024-10-28T16:30', duration: 55, category: '생산성 및 금융' },
      { date: '2024-10-28', app: '시스템 설정', start: '2024-10-28T19:12', duration: 32, category: '소셜 미디어' },
      { date: '2024-10-28', app: '메모', start: '2024-10-28T20:24', duration: 30, category: '생산성 및 금융' },
      { date: '2024-10-28', app: '카카오톡', start: '2024-10-28T21:36', duration: 16, category: '소셜 미디어' },
      { date: '2024-10-28', app: '미리보기', start: '2024-10-28T22:48', duration: 10, category: '소셜 미디어' },
      { date: '2024-10-29', app: 'Figma', start: '2024-10-29T13:12', duration: 209, category: '생산성 및 금융' },
      { date: '2024-10-29', app: 'Google Chrome', start: '2024-10-29T14:24', duration: 125, category: '기타' },
      { date: '2024-10-29', app: 'YouTube', start: '2024-10-29T15:36', duration: 54, category: '엔터테인먼트' },
      { date: '2024-10-29', app: '스티커', start: '2024-10-29T16:48', duration: 52, category: '기타' },
      { date: '2024-10-30', app: 'Figma', start: '2024-10-30T13:30', duration: 209, category: '생산성 및 금융' },
      { date: '2024-10-30', app: 'Google Chrome', start: '2024-10-30T15:00', duration: 125, category: '기타' },
      { date: '2024-10-30', app: '카카오톡', start: '2024-10-30T16:30', duration: 56, category: '소셜 미디어' },
      { date: '2024-10-30', app: '시스템 설정', start: '2024-10-30T19:00', duration: 49, category: '기타' },
      { date: '2024-10-30', app: 'Adobe Illustrator', start: '2024-10-30T20:00', duration: 33, category: '생산성 및 금융' },
      { date: '2024-10-30', app: '메모', start: '2024-10-30T21:00', duration: 30, category: '생산성 및 금융' },
      { date: '2024-10-30', app: 'YouTube', start: '2024-10-30T22:00', duration: 19, category: '엔터테인먼트' },
      { date: '2024-10-30', app: 'Safari', start: '2024-10-30T23:00', duration: 19, category: '기타' },
      { date: '2024-10-31', app: 'Figma', start: '2024-10-31T13:12', duration: 210, category: '생산성 및 금융' },
      { date: '2024-10-31', app: 'Cursor', start: '2024-10-31T14:24', duration: 156, category: '생산성 및 금융' },
      { date: '2024-10-31', app: 'Google Chrome', start: '2024-10-31T15:36', duration: 77, category: '기타' },
      { date: '2024-10-31', app: '카카오톡', start: '2024-10-31T16:48', duration: 76, category: '소셜 미디어' },
      { date: '2024-10-31', app: '미리보기', start: '2024-10-31T18:45', duration: 45, category: '생산성 및 금융' },
      { date: '2024-10-31', app: '기타', start: '2024-10-31T19:30', duration: 43, category: '생산성 및 금융' },
      { date: '2024-10-31', app: '시스템 설정', start: '2024-10-31T20:15', duration: 39, category: '생산성 및 금융' },
      { date: '2024-10-31', app: 'Adobe Illustrator', start: '2024-10-31T21:00', duration: 33, category: '생산성 및 금융' },
      { date: '2024-10-31', app: 'Finder', start: '2024-10-31T21:45', duration: 25, category: '생산성 및 금융' },
      { date: '2024-10-31', app: 'YouTube', start: '2024-10-31T22:30', duration: 19, category: '엔터테인먼트' },
      { date: '2024-10-31', app: '메모', start: '2024-10-31T23:15', duration: 10, category: '생산성 및 금융' },
      { date: '2024-11-01', app: 'Cursor', start: '2024-11-01T18:45', duration: 169, category: '생산성 및 금융' },
      { date: '2024-11-01', app: 'Google Chrome', start: '2024-11-01T19:30', duration: 72, category: '기타' },
      { date: '2024-11-01', app: 'Figma', start: '2024-11-01T20:15', duration: 46, category: '생산성 및 금융' },
      { date: '2024-11-01', app: '카카오톡', start: '2024-11-01T21:00', duration: 46, category: '소셜 미디어' },
      { date: '2024-11-01', app: '메모', start: '2024-11-01T21:45', duration: 36, category: '생산성 및 금융' },
      { date: '2024-11-01', app: '스티커', start: '2024-11-01T22:30', duration: 33, category: '기타' },
      { date: '2024-11-01', app: '미리보기', start: '2024-11-01T23:15', duration: 22, category: '기타' },
      { date: '2024-11-02', app: 'Figma', start: '2024-11-02T03:00', duration: 172, category: '생산성 및 금융' },
      { date: '2024-11-02', app: 'Google Chrome', start: '2024-11-02T14:00', duration: 114, category: '기타' },
      { date: '2024-11-02', app: '카카오톡', start: '2024-11-02T16:00', duration: 68, category: '소셜 미디어' },
      { date: '2024-11-03', app: 'Figma', start: '2024-11-03T03:00', duration: 336, category: '생산성 및 금융' },
      { date: '2024-11-03', app: 'Google Chrome', start: '2024-11-03T13:30', duration: 72, category: '기타' },
      { date: '2024-11-03', app: '카카오톡', start: '2024-11-03T15:00', duration: 40, category: '소셜 미디어' },
      { date: '2024-11-03', app: 'Claude', start: '2024-11-03T16:30', duration: 27, category: '소셜 미디어' },
      { date: '2024-11-03', app: 'Finder', start: '2024-11-03T19:30', duration: 18, category: '생산성 및 금융' },
      { date: '2024-11-03', app: 'Cursor', start: '2024-11-03T21:00', duration: 16, category: '생산성 및 금융' },
      { date: '2024-11-03', app: 'YouTube', start: '2024-11-03T22:30', duration: 10, category: '엔터테인먼트' },
      { date: '2024-11-04', app: 'Google Chrome', start: '2024-11-04T19:00', duration: 125, category: '기타' },
      { date: '2024-11-04', app: 'Figma', start: '2024-11-04T20:00', duration: 59, category: '생산성 및 금융' },
      { date: '2024-11-04', app: '카카오톡', start: '2024-11-04T21:00', duration: 53, category: '소셜 미디어' },
      { date: '2024-11-04', app: 'Cursor', start: '2024-11-04T22:00', duration: 50, category: '생산성 및 금융' },
      { date: '2024-11-04', app: 'Finder', start: '2024-11-04T23:00', duration: 25, category: '생산성 및 금융' },
      { date: '2024-11-05', app: 'Figma', start: '2024-11-05T03:00', duration: 130, category: '생산성 및 금융' },
      { date: '2024-11-05', app: 'Finder', start: '2024-11-05T19:00', duration: 52, category: '생산성 및 금융' },
      { date: '2024-11-05', app: 'Google Chrome', start: '2024-11-05T20:00', duration: 43, category: '기타' },
      { date: '2024-11-05', app: '카카오톡', start: '2024-11-05T21:00', duration: 29, category: '소셜 미디어' },
      { date: '2024-11-05', app: 'YouTube', start: '2024-11-05T22:00', duration: 10, category: '엔터테인먼트' },
      { date: '2024-11-05', app: 'Safari', start: '2024-11-05T23:00', duration: 10, category: '기타' },
      { date: '2024-11-06', app: 'Figma', start: '2024-11-06T13:12', duration: 319, category: '생산성 및 금융' },
      { date: '2024-11-06', app: '카카오톡', start: '2024-11-06T14:24', duration: 142, category: '소셜 미디어' },
      { date: '2024-11-06', app: 'Cursor', start: '2024-11-06T15:36', duration: 88, category: '생산성 및 금융' },
      { date: '2024-11-06', app: 'YouTube', start: '2024-11-06T16:48', duration: 71, category: '엔터테인먼트' },
      { date: '2024-11-06', app: 'Google Chrome', start: '2024-11-06T19:12', duration: 43, category: '기타' },
      { date: '2024-11-06', app: 'Safari', start: '2024-11-06T20:24', duration: 25, category: '기타' },
      { date: '2024-11-06', app: '미리보기', start: '2024-11-06T21:36', duration: 11, category: '소셜 미디어' },
      { date: '2024-11-06', app: '메모', start: '2024-11-06T22:48', duration: 7, category: '생산성 및 금융' },
      { date: '2024-11-07', app: 'Cursor', start: '2024-11-07T13:00', duration: 244, category: '생산성 및 금융' },
      { date: '2024-11-07', app: 'Google Chrome', start: '2024-11-07T14:00', duration: 227, category: '기타' },
      { date: '2024-11-07', app: '카카오톡', start: '2024-11-07T15:00', duration: 145, category: '소셜 미디어' },
      { date: '2024-11-07', app: 'Figma', start: '2024-11-07T16:00', duration: 132, category: '생산성 및 금융' },
      { date: '2024-11-07', app: 'YouTube', start: '2024-11-07T17:00', duration: 77, category: '엔터테인먼트' },
      { date: '2024-11-07', app: '메모', start: '2024-11-07T19:30', duration: 49, category: '생산성 및 금융' },
      { date: '2024-11-07', app: '시스템 설정', start: '2024-11-07T21:00', duration: 20, category: '소셜 미디어' },
      { date: '2024-11-07', app: 'Safari', start: '2024-11-07T22:30', duration: 18, category: '기타' },
      { date: '2024-11-08', app: 'Figma', start: '2024-11-08T02:00', duration: 151, category: '생산성 및 금융' },
      { date: '2024-11-08', app: 'Adobe InDesign', start: '2024-11-08T04:00', duration: 47, category: '생산성 및 금융' },
      { date: '2024-11-08', app: 'Adobe Illustrator', start: '2024-11-08T09:00', duration: 20, category: '생산성 및 금융' },
      { date: '2024-11-08', app: 'Safari', start: '2024-11-08T14:00', duration: 56, category: '기타' },
      { date: '2024-11-08', app: 'Google Chrome', start: '2024-11-08T16:00', duration: 23, category: '기타' },
      { date: '2024-11-08', app: '카카오톡', start: '2024-11-08T20:00', duration: 19, category: '소셜 미디어' },
      { date: '2024-11-08', app: 'Finder', start: '2024-11-08T22:00', duration: 7, category: '생산성 및 금융' },
      { date: '2024-11-09', app: 'Google Chrome', start: '2024-11-09T02:00', duration: 160, category: '기타' },
      { date: '2024-11-09', app: 'Cursor', start: '2024-11-09T04:00', duration: 149, category: '생산성 및 금융' },
      { date: '2024-11-09', app: '카카오톡', start: '2024-11-09T13:30', duration: 84, category: '소셜 미디어' },
      { date: '2024-11-09', app: 'Adobe InDesign', start: '2024-11-09T15:00', duration: 46, category: '생산성 및 금융' },
      { date: '2024-11-09', app: 'Claude', start: '2024-11-09T16:30', duration: 11, category: '소셜 미디어' },
      { date: '2024-11-09', app: 'Finder', start: '2024-11-09T20:00', duration: 10, category: '생산성 및 금융' },
      { date: '2024-11-09', app: 'Figma', start: '2024-11-09T22:00', duration: 8, category: '생산성 및 금융' },
      { date: '2024-11-10', app: 'Google Chrome', start: '2024-11-10T02:00', duration: 150, category: '기타' },
      { date: '2024-11-10', app: 'Cursor', start: '2024-11-10T04:00', duration: 100, category: '생산성 및 금융' },
      { date: '2024-11-10', app: 'Google Chrome', start: '2024-11-10T13:12', duration: 113, category: '기타' },
      { date: '2024-11-10', app: '카카오톡', start: '2024-11-10T14:24', duration: 80, category: '소셜 미디어' },
      { date: '2024-11-10', app: 'YouTube', start: '2024-11-10T15:36', duration: 52, category: '엔터테인먼트' },
      { date: '2024-11-10', app: 'Figma', start: '2024-11-10T16:48', duration: 47, category: '생산성 및 금융' },
      { date: '2024-11-10', app: 'Cursor', start: '2024-11-10T19:12', duration: 153, category: '생산성 및 금융' },
      { date: '2024-11-10', app: '카카오톡', start: '2024-11-10T20:24', duration: 48, category: '소셜 미디어' },
      { date: '2024-11-10', app: '메모', start: '2024-11-10T21:36', duration: 28, category: '생산성 및 금융' },
      { date: '2024-11-10', app: 'Finder', start: '2024-11-10T22:48', duration: 24, category: '생산성 및 금융' },
      { date: '2024-11-11', app: '카카오톡', start: '2024-11-11T02:00', duration: 100, category: '소셜 미디어' },
      { date: '2024-11-11', app: 'Cursor', start: '2024-11-11T04:00', duration: 110, category: '생산성 및 금융' },
      { date: '2024-11-11', app: '카카오톡', start: '2024-11-11T08:00', duration: 45, category: '소셜 미디어' },
      { date: '2024-11-11', app: 'YouTube', start: '2024-11-11T10:00', duration: 21, category: '엔터테인먼트' },
      { date: '2024-11-11', app: 'Google Chrome', start: '2024-11-11T14:00', duration: 68, category: '기타' },
      { date: '2024-11-11', app: 'Figma', start: '2024-11-11T16:00', duration: 9, category: '생산성 및 금융' },
      { date: '2024-11-12', app: 'Figma', start: '2024-11-12T02:00', duration: 100, category: '생산성 및 금융' },
      { date: '2024-11-12', app: 'Google Chrome', start: '2024-11-12T04:00', duration: 84, category: '기타' },
      { date: '2024-11-12', app: 'Figma', start: '2024-11-12T13:00', duration: 184, category: '생산성 및 금융' },
      { date: '2024-11-12', app: 'Google Chrome', start: '2024-11-12T14:00', duration: 151, category: '기타' },
      { date: '2024-11-12', app: '카카오톡', start: '2024-11-12T15:00', duration: 108, category: '소셜 미디어' },
      { date: '2024-11-12', app: 'Adobe Photoshop', start: '2024-11-12T16:00', duration: 44, category: '생산성 및 금융' },
      { date: '2024-11-12', app: 'Cursor', start: '2024-11-12T17:00', duration: 12, category: '생산성 및 금융' },
      { date: '2024-11-12', app: 'Finder', start: '2024-11-12T20:00', duration: 8, category: '생산성 및 금융' },
      { date: '2024-11-12', app: 'Safari', start: '2024-11-12T22:00', duration: 3, category: '기타' },
      { date: '2024-11-13', app: 'Figma', start: '2024-11-13T01:30', duration: 100, category: '생산성 및 금융' },
      { date: '2024-11-13', app: 'Google Chrome', start: '2024-11-13T03:00', duration: 80, category: '기타' },
      { date: '2024-11-13', app: 'Cursor', start: '2024-11-13T04:30', duration: 47, category: '생산성 및 금융' },
      { date: '2024-11-13', app: 'Figma', start: '2024-11-13T12:51', duration: 227, category: '생산성 및 금융' },
      { date: '2024-11-13', app: 'Google Chrome', start: '2024-11-13T13:43', duration: 151, category: '기타' },
      { date: '2024-11-13', app: 'Cursor', start: '2024-11-13T14:34', duration: 99, category: '생산성 및 금융' },
      { date: '2024-11-13', app: '카카오톡', start: '2024-11-13T15:26', duration: 85, category: '소셜 미디어' },
      { date: '2024-11-13', app: 'Adobe Illustrator', start: '2024-11-13T16:17', duration: 31, category: '생산성 및 금융' },
      { date: '2024-11-13', app: 'YouTube', start: '2024-11-13T17:09', duration: 30, category: '엔터테인먼트' },
      { date: '2024-11-13', app: 'Finder', start: '2024-11-13T20:00', duration: 24, category: '생산성 및 금융' },
      { date: '2024-11-13', app: 'Zoom', start: '2024-11-13T22:00', duration: 22, category: '생산성 및 금융' },
      { date: '2024-11-14', app: 'Cursor', start: '2024-11-14T01:12', duration: 218, category: '생산성 및 금융' },
      { date: '2024-11-14', app: 'Google Chrome', start: '2024-11-14T02:24', duration: 153, category: '기타' },
      { date: '2024-11-14', app: '카카오톡', start: '2024-11-14T03:36', duration: 98, category: '소셜 미디어' },
      { date: '2024-11-14', app: 'Figma', start: '2024-11-14T04:48', duration: 70, category: '생산성 및 금융' },
      { date: '2024-11-14', app: 'YouTube', start: '2024-11-14T19:12', duration: 83, category: '엔터테인먼트' },
      { date: '2024-11-14', app: 'GitHub Desktop', start: '2024-11-14T20:24', duration: 20, category: '엔터테인먼트' },
      { date: '2024-11-14', app: 'Finder', start: '2024-11-14T21:36', duration: 6, category: '생산성 및 금융' },
      { date: '2024-11-14', app: '메모', start: '2024-11-14T22:48', duration: 3, category: '생산성 및 금융' }
    ];

    // 긴 사용 시간을 더 촘촘한 세션으로 쪼개어 과로감을 극대화
    const CHUNK_MINUTES = 30; // 30분 단위로 분할 (15로 줄이면 더 빽빽해짐)

    const usageEvents = rawUsageEvents.flatMap(event => {
      const total = Number(event.duration) || 0;
      if (total <= 0) return [];

      const chunks = Math.max(1, Math.round(total / CHUNK_MINUTES));
      if (chunks === 1) return [event];

      const chunkDur = total / chunks;
      const startDate = new Date(event.start);

      // 전체 구간을 chunks 개의 시작점으로 균등 분할
      const spanMinutes = total - chunkDur;
      const step = chunks > 1 ? spanMinutes / (chunks - 1) : 0;

      const segments = [];
      for (let i = 0; i < chunks; i++) {
        const offsetMin = step * i;
        const t = new Date(startDate.getTime() + offsetMin * 60 * 1000);
        const hh = String(t.getHours()).padStart(2, '0');
        const mm = String(t.getMinutes()).padStart(2, '0');

        segments.push({
          date: event.date,
          app: event.app,
          start: `${event.date}T${hh}:${mm}`,
          duration: chunkDur,
          category: event.category
        });
      }
      return segments;
    });

    // 날짜별·앱별 총 사용 시간을 계산해, 날짜마다 가장 많이 사용한 앱을 선택
    const dateAppTotals = rawUsageEvents.reduce((acc, ev) => {
      const dateKey = ev.date;
      const appKey = ev.app;
      const dur = Number(ev.duration) || 0;
      if (!acc[dateKey]) acc[dateKey] = {};
      acc[dateKey][appKey] = (acc[dateKey][appKey] || 0) + dur;
      return acc;
    }, {});

    const topAppByDate = new Map();
    Object.entries(dateAppTotals).forEach(([date, appMap]) => {
      let topApp = null;
      let topTotal = -Infinity;
      Object.entries(appMap).forEach(([app, total]) => {
        if (total > topTotal) {
          topTotal = total;
          topApp = app;
        }
      });
      topAppByDate.set(date, topApp);
    });

    // 날짜별로, 그 날짜에서 가장 많이 사용한 앱의 대표 이벤트(가장 긴 조각)를 하나만 강조
    const highlightByDate = new Map();
    usageEvents.forEach(ev => {
      const topApp = topAppByDate.get(ev.date);
      if (!topApp || ev.app !== topApp) return;
      const current = highlightByDate.get(ev.date);
      if (!current || ev.duration > current.duration) {
        highlightByDate.set(ev.date, ev);
      }
    });

    const categoryStyles = {
      '생산성 및 금융': { fill: '#111111', stroke: 'rgba(17,17,17,0.65)' },
      '기타': { fill: '#3c3936', stroke: 'rgba(17,17,17,0.54)' },
      '소셜 미디어': { fill: '#6b6762', stroke: 'rgba(17,17,17,0.4)' },
      '엔터테인먼트': { fill: '#9a958d', stroke: 'rgba(17,17,17,0.3)' }
    };

    const getStyleForCategory = (category) => categoryStyles[category] || { fill: '#b0aba2', stroke: 'rgba(17,17,17,0.35)' };

    const svg = document.getElementById('chart');
    const viewBox = svg.viewBox && svg.viewBox.baseVal;
    const width = viewBox && viewBox.width ? viewBox.width : Number(svg.getAttribute('width'));
    const height = viewBox && viewBox.height ? viewBox.height : Number(svg.getAttribute('height'));
    const centerX = width / 2;
    const centerY = height / 2;
    const outerRadius = Math.min(width, height) / 2 - 80;
    const innerRadius = 110;

    const parseDate = (value) => new Date(value);
    const uniqueDates = Array.from(new Set(usageEvents.map(d => d.date))).sort((a,b) => parseDate(a) - parseDate(b));
    const ringSpacing = uniqueDates.length > 1 ? (outerRadius - innerRadius) / (uniqueDates.length - 1) : 0;
    const hourAngles = Array.from({ length: 24 }, (_, hour) => hour);

    const tooltip = document.getElementById('tooltip');
    const tooltipName = tooltip.querySelector('.name');
    const tooltipDate = tooltip.querySelector('.date');
    const tooltipTime = tooltip.querySelector('.time');
    const tooltipDuration = tooltip.querySelector('.duration');
    const tooltipCat = tooltip.querySelector('.category');

    const toAngle = (dateString) => {
      const date = parseDate(dateString);
      const minutes = date.getHours() * 60 + date.getMinutes();
      return (minutes / (24 * 60)) * Math.PI * 2 - Math.PI / 2;
    };

    const getRadius = (date) => {
      if (uniqueDates.length === 1) return innerRadius;
      const idx = uniqueDates.indexOf(date);
      return innerRadius + idx * ringSpacing;
    };

    const polarToCartesian = (angle, radius) => ({
      x: centerX + Math.cos(angle) * radius,
      y: centerY + Math.sin(angle) * radius
    });

    const append = (tag, attrs = {}, parent = svg) => {
      const el = document.createElementNS('http://www.w3.org/2000/svg', tag);
      Object.entries(attrs).forEach(([key, value]) => el.setAttribute(key, value));
      parent.appendChild(el);
      return el;
    };

    const gridGroup = append('g', { 'stroke-linecap': 'round' });
    const ringGroup = append('g', {}, gridGroup);
    const hourGroup = append('g', {}, gridGroup);
    const markerGroup = append('g', { opacity: '0.75' });

    const baseRingCount = uniqueDates.length * 4 + 24;
    for (let i = 0; i <= baseRingCount; i++) {
      const radius = innerRadius + (i / baseRingCount) * (outerRadius - innerRadius);
      append('circle', {
        cx: centerX,
        cy: centerY,
        r: radius,
        fill: 'none',
        stroke: i % 4 === 0 ? 'rgba(15,15,15,0.15)' : 'rgba(15,15,15,0.08)',
        'stroke-width': i % 4 === 0 ? '0.9' : '0.45',
        'stroke-dasharray': i % 4 === 0 ? 'none' : '2 8'
      }, ringGroup);
    }

    const dayLinkGroup = append('g', { fill: 'none' });
    const connectorGroup = append('g', { stroke: '#111111', 'stroke-width': '1.1', 'stroke-linecap': 'round', opacity: '0.7' });
    const dataGroup = append('g');

    hourAngles.forEach(hour => {
      const angle = (hour / 24) * Math.PI * 2 - Math.PI / 2;
      const { x, y } = polarToCartesian(angle, outerRadius);
      append('line', {
        x1: centerX,
        y1: centerY,
        x2: x,
        y2: y,
        stroke: hour % 3 === 0 ? 'rgba(15,15,15,0.22)' : 'rgba(15,15,15,0.1)',
        'stroke-width': hour % 3 === 0 ? '1.4' : '0.65',
        'stroke-dasharray': hour % 3 === 0 ? 'none' : '4 10',
        opacity: hour % 3 === 0 ? '0.9' : '0.6'
      }, hourGroup);

      if (hour % 3 === 0) {
        const labelPoint = polarToCartesian(angle, outerRadius + 30);
        const text = append('text', {
          x: labelPoint.x,
          y: labelPoint.y,
          'text-anchor': 'middle',
          'dominant-baseline': 'middle',
          fill: 'var(--brand-mid)',
          'font-size': '11',
          opacity: '0.72',
          'font-weight': '500',
          'letter-spacing': '0.08em'
        }, hourGroup);
        text.textContent = hour === 0 ? '0시' : `${hour}시`;
      }
    });

    uniqueDates.forEach((date, index) => {
      const radius = getRadius(date);
      const labelPoint = polarToCartesian(Math.PI / 2, radius + 4);
      const text = append('text', {
        x: labelPoint.x,
        y: labelPoint.y + 16,
        'text-anchor': 'middle',
        fill: 'var(--brand-mid)',
        'font-size': '11',
        'font-weight': index === uniqueDates.length - 1 ? '600' : '500',
        opacity: index === uniqueDates.length - 1 ? '0.88' : '0.58',
        'letter-spacing': '0.12em'
      }, markerGroup);
      const dateLabel = new Date(date);
      text.textContent = `${dateLabel.getMonth() + 1}/${dateLabel.getDate()}`;
    });

    append('circle', {
      cx: centerX,
      cy: centerY,
      r: innerRadius - 36,
      fill: 'rgba(15,15,15,0.05)'
    }, gridGroup);

    const pointsByDate = new Map();

    usageEvents.forEach(event => {
      const angle = toAngle(event.start);
      const baseRadius = getRadius(event.date);
      const radius = baseRadius;
      const { x, y } = polarToCartesian(angle, radius);
      const baseSize = Math.max(3, Math.min(13, Math.sqrt(event.duration) * 1.05));
      const isHighlight = highlightByDate.get(event.date) === event;
      const size = isHighlight ? baseSize * 1.6 : baseSize;
      const style = getStyleForCategory(event.category);

      const baseStrokeWidth = size > 7 ? 1.2 : 0.8;
      const circle = append('circle', {
        cx: x,
        cy: y,
        r: size,
        fill: isHighlight ? '#d12a2a' : style.fill,
        opacity: isHighlight ? '0.96' : '0.78',
        stroke: isHighlight ? '#d12a2a' : style.stroke,
        'stroke-width': baseStrokeWidth
      }, dataGroup);

      append('line', {
        x1: centerX,
        y1: centerY,
        x2: x,
        y2: y
      }, connectorGroup);

      if (!pointsByDate.has(event.date)) {
        pointsByDate.set(event.date, []);
      }
      pointsByDate.get(event.date).push({ x, y, angle, radius: baseRadius });

      circle.style.cursor = 'pointer';
      circle.style.mixBlendMode = 'multiply';
      circle.dataset.baseStrokeWidth = String(baseStrokeWidth);

      circle.addEventListener('mouseenter', () => {
        circle.setAttribute('opacity', '1');
        circle.setAttribute('stroke-width', String(baseStrokeWidth + 0.6));
        tooltipName.textContent = event.app;
        tooltipDate.textContent = `날짜: ${event.date}`;
        const startDate = parseDate(event.start);
        const hh = startDate.getHours().toString().padStart(2, '0');
        const mm = startDate.getMinutes().toString().padStart(2, '0');
        tooltipTime.textContent = `시작: ${hh}:${mm}`;
        tooltipDuration.textContent = `지속: ${Math.floor(event.duration / 60)}시간 ${event.duration % 60}분`;
        tooltipCat.textContent = `카테고리: ${event.category}`;
        tooltip.style.display = 'block';
      });

      circle.addEventListener('mousemove', (evt) => {
        const rect = svg.getBoundingClientRect();
        tooltip.style.left = `${evt.clientX - rect.left + 20}px`;
        tooltip.style.top = `${evt.clientY - rect.top + 20}px`;
      });

      circle.addEventListener('mouseleave', () => {
        circle.setAttribute('opacity', '0.78');
        circle.setAttribute('stroke-width', circle.dataset.baseStrokeWidth);
        tooltip.style.display = 'none';
      });
    });

    pointsByDate.forEach(points => {
      if (points.length < 2) return;
      const sorted = points.slice().sort((a, b) => a.angle - b.angle);
      let d = `M${sorted[0].x.toFixed(2)} ${sorted[0].y.toFixed(2)}`;
      for (let i = 1; i < sorted.length; i++) {
        const prev = sorted[i - 1];
        const curr = sorted[i];
        let delta = curr.angle - prev.angle;
        if (delta < 0) delta += Math.PI * 2;
        const largeArcFlag = delta > Math.PI ? 1 : 0;
        d += ` A ${curr.radius.toFixed(2)} ${curr.radius.toFixed(2)} 0 ${largeArcFlag} 1 ${curr.x.toFixed(2)} ${curr.y.toFixed(2)}`;
      }
      append('path', {
        d,
        stroke: '#111111',
        'stroke-width': '1.1',
        'stroke-linecap': 'round',
        'stroke-linejoin': 'round',
        opacity: '0.75'
      }, dayLinkGroup);
    });
  </script>
</body>
</html>





